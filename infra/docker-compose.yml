# Docker Compose configuration for the complete hackathon environment
# Defines services for attacker, proxy, network capture, and agent
# Expresses how volumes are shared between services:
#   - telemetry logs
#   - PCAP/flow summaries be carefull here, can slow down everything, see network dockerfile
#   - BlueFlux output reports
# Serves as a single "run this to see the demo" artifact

#Docker log timestamps and Network timestamps might drift. Ensure all containers use UTC

services:
  llm_proxy:
    build:
      context: ..
      dockerfile: infra/Dockerfile.llm_proxy
    container_name: blueflux_proxy
    volumes:
      - ./data:/data
      - ./logs/llm_logs:/data/llm_logs
    ports:
      - "8080:8080"
    env_file:
      - ../.env
    environment:
      - TZ=UTC
    networks:
      - blueflux_net

  attacker:
    build:
      context: ..
      dockerfile: infra/Dockerfile.attacker
    container_name: blueflux_attacker
    volumes:
      - ./data:/data
      - ./logs/llm_logs:/data/llm_logs
    depends_on:
      - llm_proxy
    environment:
      - TZ=UTC
      - PROXY_URL=http://llm_proxy:8080
    networks:
      - blueflux_net

networks:
  blueflux_net:
    driver: bridge